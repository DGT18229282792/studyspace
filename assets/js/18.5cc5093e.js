(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{292:function(n,e,t){"use strict";t.r(e);var r=t(14),o=Object(r.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("p",[n._v("所谓埋点就是，监听用户操作、页面性能、模块活跃，系统各类日志等一系列的操作。")]),n._v(" "),e("p",[n._v("这里实现了一个类用来进行前端的埋点操作：")]),n._v(" "),e("div",{staticClass:"language-plain extra-class"},[e("pre",{pre:!0,attrs:{class:"language-plain"}},[e("code",[n._v('export let url = "www.baidu.com";\nexport class StatisticSDK {\n  constructor(sdkId) {\n    this.sdkId = sdkId;\n    // 初始化上报加载信息数据\n    this.initPerformance();\n    // 初始化错误监控\n    this.initError();\n  }\n  // 利用img来发送数据\n  send(topicUrl, option = {}) {\n    option.productID = this.sdkId;\n    let queryStr = Object.entries(option)\n      .map(([key, value]) => `${key}=${value}`)\n      .join("&");\n    let img = new Image();\n    img.src = `${topicUrl}?${queryStr}`;\n  }\n  // 自定义事件\n  event(key, val = {}) {\n    let eventURL = url;\n    this.send(eventURL, { event: key, ...val });\n  }\n  // pv曝光\n  pv() {\n    this.event("pv");\n  }\n  // 性能上报\n  initPerformance() {\n    console.table(performance.timing);\n    let performanceURL = url;\n    this.send(performanceURL, performance.timing);\n  }\n  // 自定义错误上报\n  error(err, etraInfo = {}) {\n    const errorURL = url;\n    const { message, stack } = err;\n    this.send(errorURL, { message, stack, ...etraInfo });\n  }\n  // 初始化错误监控\n  initError() {\n    // 捕获监听DOM操作错误DOMException和JS错误告警\n    window.addEventListener("error", (event) => {\n      this.error(event);\n    });\n    // 捕获promise错误\n    window.addEventListener("unhandledrejection", (event) => {\n      this.error(new Error(event.reason), { type: "unhandledrejection" });\n    });\n  }\n}\n// 在vue中使用这个sdk可以在vue中有一个专门的生命周期可以在里面进行监听\n// errorCaptured (err, vm, info) {\n//     this.error = `${err.stack}\\n\\nfound in ${info} of component`\n//     // 调用我们的SDK，上报错误信息\n//     insSDK.error(err,info)\n//     return false\n//   }\n')])])]),e("p",[n._v("使用：在main.js中进行引入")]),n._v(" "),e("div",{staticClass:"language-plain extra-class"},[e("pre",{pre:!0,attrs:{class:"language-plain"}},[e("code",[n._v("import Vue from 'vue'\nimport App from './App.vue'\nimport { StatisticSDK } from '@/sdk/monitor-sdk'\nVue.prototype.StatisticSDK = new StatisticSDK('123456789')\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n")])])]),e("p",[n._v("源码："),e("a",{attrs:{href:"https://github.com/DGT18229282792/monitor-sdk",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://github.com/DGT18229282792/monitor-sdk"),e("OutboundLink")],1),n._v("\n参考博客："),e("a",{attrs:{href:"https://juejin.cn/post/7085679511290773534#heading-0",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://juejin.cn/post/7085679511290773534#heading-0"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=o.exports}}]);